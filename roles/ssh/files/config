Include ~/.colima/ssh_config

Host *
    ServerAliveInterval 60
    TCPKeepAlive yes
    StrictHostKeyChecking no
    UseKeychain yes
    AddKeysToAgent yes
    ControlPath ~/.ssh/sockets/master-%r@%h:%p
    ControlPersist 12h

# Use 1Password agent socket when:
# - Not in an interactive SSH session (SSH_TTY unset)
# - SSH_AUTH_SOCK is unset OR points to macOS keychain (com.apple.launchd)
# - Running on macOS (Darwin)
# - 1Password socket exists
# This ensures we use 1Password locally (overriding macOS keychain), but respect
# forwarded agents when SSH_AUTH_SOCK is set and doesn't point to macOS keychain
Match host * exec "sh -c 'test -z \"$SSH_TTY\" && uname | grep -q Darwin && test -S ~/Library/Group\ Containers/2BUA8C4S2C.com.1password/t/agent.sock && (test -z \"$SSH_AUTH_SOCK\" || echo \"$SSH_AUTH_SOCK\" | grep -q \"com.apple.launchd\")'"
    IdentityAgent "~/Library/Group Containers/2BUA8C4S2C.com.1password/t/agent.sock"

Host crojtini
    Hostname crojtini.local
    User inkatze
    ForwardAgent yes
    SendEnv ANTHROPIC_API_KEY

Host rfh.rsync.net
    Hostname usw-s004.rsync.net
    User 40377
